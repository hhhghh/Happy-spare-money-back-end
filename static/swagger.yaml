swagger: "2.0"
info:
  description: "This is a sample test.  You can find out more at [https://github.com/hhhghh/Dashboard](https://github.com/hhhghh/Dashboard)     For this sample, you can use the api key `special-key` to test the authorization filters."
  version: "1.0.0"
  title: "Happy spare money"
host: "localhost:3000"
basePath: /api/v1

tags:
- name: "Team"
  description: "Everything about your Teams"
  externalDocs:
    description: "Find out more "
    url: "https://github.com/hhhghh/Dashboard/blob/master/api_design_group.md"
- name: "User"
  description: "Operations about user"
  externalDocs:
    description: "Find out more "
    url: "https://github.com/hhhghh/Dashboard/blob/master/api_design_user.md"
- name: "Task"
  description: "Operations about task"
  externalDocs:
    description: "Find out more "
    url: "https://github.com/hhhghh/Dashboard/blob/master/api%E8%AE%BE%E8%AE%A1.md"   
    
schemes:
- "http"
- "https"

paths:
  /team/Id:
    get:
      tags:
      - "Team"
      summary: "Find team by Id"
      description: "Returns a single team"
      operationId: "getTeamById"
      produces:
      - "application/json"
      - "application/xml"
      parameters:
      - name: "team_id"
        in: "query"
        description: "ID of team to return"
        required: true
        type: "integer"
        format: "int32"
      responses:
        200:
          description: "Successful operation"
          schema:
            $ref: "#/definitions/Team"
        412:
          description: "Abnormal"
        413:
          description: "Team not found"
      
  /team/Leader:
    get:
      tags:
      - "Team"
      summary: "Judge whether it is team Leader"
      description: "Returns true or false"
      operationId: "isTeamLeader"
      produces:
      - "application/json"
      - "application/xml"
      parameters:
      - name: "team_id"
        in: "query"
        description: "ID of team"
        required: true
        type: "integer"
        format: "int32"
      - name: "leader"
        in: "query"
        description: "leader of team"
        required: true
        type: "string"
      responses:
        200:
          description: "Is team leader"
        412:
          description: "Abnormal"
        413:
          description: "Is not team leader"
    
    post:
      tags:
      - "Team"
      summary: "Change leader"
      description: "Returns true or false"
      operationId: "updateTeamLeader"
      produces:
      - "application/json"
      - "application/xml"
      parameters:
      - name: "body"
        in: "body"
        description: "Create team object"
        required: true
        schema:
          $ref: "#/definitions/Invitation"

      responses:
        200:
          description: "Successful operation"
        412:
          description: "Abnormal"
        413:
          description: "Team leader is wrong"
        414:
          description: "Team member is wrong"
          
  /team/Member:
    get:
      tags:
      - "Team"
      summary: "Judge whether it is team Member"
      description: "Returns true or false"
      operationId: "isTeamMember"
      produces:
      - "application/json"
      - "application/xml"
      parameters:
      - name: "team_id"
        in: "query"
        description: "ID of team"
        required: true
        type: "integer"
        format: "int32"
      - name: "member_username"
        in: "query"
        description: "member of team"
        required: true
        type: "string"
      responses:
        200:
          description: "Is team member"
        412:
          description: "Abnormal"
        413:
          description: "Is not team member"
          
  /team/Name:
    get:
      tags:
      - "Team"
      summary: "Find team by Name"
      description: "Returns a team list"
      operationId: "getTeamByTeamName"
      produces:
      - "application/json"
      - "application/xml"
      parameters:
      - name: "team_name"
        in: "query"
        description: "Name of team"
        required: true
        type: "string"
      responses:
        200:
          description: "Successful operation"
          schema:
            type: "array"
            items:
              $ref: "#/definitions/Team"
        412:
          description: "Abnormal"
        413:
          description: "Team not found"
          
  /team/Label:
    get:
      tags:
      - "Team"
      summary: "Find team by Label"
      description: "Returns a team list"
      operationId: "getTeamByTeamLabel"
      produces:
      - "application/json"
      - "application/xml"
      parameters:
      - name: "label"
        in: "query"
        description: "Label of team"
        required: true
        type: "string"
      responses:
        200:
          description: "Successful operation"
          schema:
            type: "array"
            items:
              $ref: "#/definitions/Team"
        412:
          description: "Abnormal"
        413:
          description: "Team not found"
          
  /team/MemberName:
    get:
      tags:
      - "Team"
      summary: "Find team by MemberName"
      description: "Returns a team list"
      operationId: "getTeamByMemberName"
      produces:
      - "application/json"
      - "application/xml"
      parameters:
      - name: "member_username"
        in: "query"
        description: "MemberName of team"
        required: true
        type: "string"
      responses:
        200:
          description: "Successful operation"
          schema:
            type: "array"
            items:
              $ref: "#/definitions/Team"
        412:
          description: "Abnormal"
        413:
          description: "Not joining the team" 
          
  /team:
    post:
      tags:
      - "Team"
      summary: "Create team"
      description: "Returns a simgle team"
      operationId: "CreateTeam"
      produces:
      - "application/json"
      - "application/xml"
      parameters:
      - name: "body"
        in: "body"
        description: "Create team object"
        required: true
        schema:
          $ref: "#/definitions/TeamModel"
      responses:
        200:
          description: "Successful operation"
          schema:
            $ref: "#/definitions/Team"
        412:
          description: "Abnormal"
        413:
          description: "Team leader does not exist"
        414:
          description: "Some Team members does not exist"
        416:
          description: "Parameter incomplete"
   
    put:
      tags:
      - "Team"
      summary: "Modify team"
      description: "Returns a simgle team"
      operationId: "ModifyTeam"
      produces:
      - "application/json"
      - "application/xml"
      parameters:
      - name: "body"
        in: "body"
        description: "Create team object"
        required: true
        schema:
          $ref: "#/definitions/TeamModel2"
      responses:
        200:
          description: "Successful operation"
          schema:
            $ref: "#/definitions/Team"
        412:
          description: "Abnormal"
        413:
          description: "Team leader or team does not exist"
        414:
          description: "Team leader does not correct"
        416:
          description: "Parameter incomplete"
    
    delete:
      tags:
      - "Team"
      summary: "Delete team"
      description: "Returns true or false"
      operationId: "deleteTeam"
      produces:
      - "application/json"
      - "application/xml"
      parameters:
      - name: "team_id"
        in: "query"
        description: "Id of team"
        required: true
        type: "integer"
        format: "int32"
      - name: "leader"
        in: "query"
        description: "Leader of team"
        required: true
        type: "string"

      responses:
        200:
          description: "Successful operation"
        412:
          description: "Abnormal"
        413:
          description: "Team leader is wrong"
          
  /team/Member/Invitation:  
    post:
      tags:
      - "Team"
      summary: "Invitation user"
      description: "Returns true or false"
      operationId: "addUserToTeam"
      produces:
      - "application/json"
      - "application/xml"
      parameters:
      - name: "body"
        in: "body"
        description: "Create team object"
        required: true
        schema:
          $ref: "#/definitions/Invitation"

      responses:
        200:
          description: "Successful operation"
        412:
          description: "Abnormal"
        413:
          description: "Team leader verification is required"
        414:
          description: "Not allowed to add"
    
  /team/Member/Addition:  
    post:
      tags:
      - "Team"
      summary: "Addition user"
      description: "Returns true or false"
      operationId: "adduserToTeam"
      produces:
      - "application/json"
      - "application/xml"
      parameters:
      - name: "body"
        in: "body"
        description: "Create team object"
        required: true
        schema:
          $ref: "#/definitions/Addition"

      responses:
        200:
          description: "Successful operation"
        412:
          description: "Abnormal"
        413:
          description: "Team leader verification is required"
        414:
          description: "Not allowed to add"    
  
  /team/Member/Dislodge:  
    delete:
      tags:
      - "Team"
      summary: "Delete user"
      description: "Returns true or false"
      operationId: "deleteUserFromTeam"
      produces:
      - "application/json"
      - "application/xml"
      parameters:
      - name: "team_id"
        in: "query"
        description: "Id of team"
        required: true
        type: "integer"
        format: "int32"
      - name: "leader"
        in: "query"
        description: "Leader of team"
        required: true
        type: "string"
      - name: "username"
        in: "query"
        description: "Member of team"
        required: true
        type: "string"

      responses:
        200:
          description: "Successful operation"
        412:
          description: "Abnormal"
        413:
          description: "Team leader is wrong"
        414:
          description: "Team leader cannot be deleted"    
        415:
          description: "The team does not have that user"
  
  /team/Member/Departure:  
    delete:
      tags:
      - "Team"
      summary: "User Leave the team"
      description: "Returns true or false"
      operationId: "deleteuserFromTeam"
      produces:
      - "application/json"
      - "application/xml"
      parameters:
      - name: "team_id"
        in: "query"
        description: "Id of team"
        required: true
        type: "integer"
        format: "int32"
      - name: "username"
        in: "query"
        description: "Member of team"
        required: true
        type: "string"

      responses:
        200:
          description: "Successful operation"
        412:
          description: "Abnormal"
        413:
          description: "Team member is wrong"
        414:
          description: "Team leader cannot leave the team"    
        415:
          description: "There is no team"

  /task:
    get:
      tags:
        - "Task"
      summary: "find tasks satisfiy the restrictions"
      description: |
        Find tasks the satisfiy the type and range, and can be seen by the user,
        type:任务类型,
        range:任务发布范围 `all`或者`group.id` 根据type
        range查找所有任务Tasks
        (根据user.id从`屏蔽列表`找到屏蔽该user的releaser查找releaser所有发布的任务t_set0. 根据Tasks信息，比较每个task.score与user.score， 若task.score > user.score, t_set1.append(task) 返回(Tasks - t_set0 - t_set1)
      operationId: "getTask"
      produces:
        - "application/json"
        - "application/xml"
      parameters:
        # - name: "acceptableOnly"
        #   in: "query"
        #   description: "Whether you want the acceptable only"
        #   required: false
        #   type: "boolean"
        - name: "type"
          in: "query"
          description: "The desired type, which can be `all` or `1,2,3` means `1 or 2 or 3`"
          required: true
          type: "string"
        - name: "range"
          in: "query"
          description: "The desired range, which can be `all` or some group id, as `type`'s description"
          required: true
          type: "string"
        - name: "username"
          in: "query"
          description: "The desired username"
          required: true
          type: "string"
      responses:
        200:
          description: "Successful execute, find some (or no) task"
          schema:
            $ref: "#/definitions/task"
        412:
          description: "Parameters is not satisfiy required"
          
    post:
      tags:
      - "Task"
      summary: "Create a task"
      description: "Returns a simgle task"
      operationId: "CreateTask"
      produces:
      - "application/json"
      - "application/xml"
      parameters:
      - name: "body"
        in: "body"
        description: "Create task object"
        required: true
        schema:
          $ref: "#/definitions/task_create_param"
      responses:
        200:
          description: "Successful create a task"
          schema:
            $ref: "#/definitions/task"
        412:
          description: "Abnormal"
        413:
          description: "Team leader does not exist"
        414:
          description: "Some Team members does not exist"
        416:
          description: "Parameter incomplete"
    
    delete:
      tags:
        - "Task"
      summary: "Delete a task by task id"
      description: "Try to delete a task by task id, should apply other informations for verification"
      produces:
        - "application/json"
        - "application/xml"
      parameters:
        - name: "task_id"
          in: "query"
          description: "The task id"
          type: "string"
          required: true
        - name: "Others param"
          in: "query"
          description: "TODO, may use session or something ... At this time, just don't need that."
          type: "string"
          required: true
      responses:
        200:
          description: "ok"
        412:
          description: "params wrong"
        403:
          description: "Unauthorized, may should use 401"
          

  /task/findByPublisher:
    get:
      tags:
        - "Task"
      summary: "Find all tasks established by publisher"
      description: "Find all tasks established by publisher"
      produces:
        - "application/json"
        - "application/xml"
      parameters:
        - name: "username"
          in: "query"
          description: "the publisher's username"
          type: "string"
          required: true
        - name: "type"
          in: "query"
          description: "the desired type"
          type: "string"
        - name: "range"
          in: "query"
          description: "the desired range"
          type: "string"
        - name: "state"
          in: "query"
          description: "the desired state of a task"
          type: "string"
      responses:
        200:
          description: "Successful execute, find some (or no) task"
          schema:
            $ref: "#/definitions/task"
        412:
          description: "Parameters is not satisfiy required"


  /task/findByTaskId:
    get:
      tags:
        - "Task"
      summary: "Find the task by the task id"
      description: "Find the task by the task id"
      produces:
        - "application/json"
        - "application/xml"
      parameters:
        - name: "task_id"
          in: "query"
          description: "the task's id"
          type: "integer"
          required: true
      responses:
        200:
          description: "Successful execute, find some (or no) task"
          schema:
            $ref: "#/definitions/task"
        412:
          description: "Parameters is not satisfiy required"

                     
  /task/findByAccepter:
    get:
      tags:
        - "Task"
      summary: "Find all tasks accepted by the user"
      description: "Find all tasks be accepted by user"
      produces:
        - "application/json"
      parameters:
        - name: "username"
          in: "query"
          description: "the user's username"
          type: "string"
          required: true
        - name: "type"
          in: "query"
          description: "the desired type"
          type: "string"
        - name: "range"
          in: "query"
          description: "the desired range"
          type: "string"
        - name: "state"
          in: "query"
          description: "the desired state"
          type: "string"
      responses:
        200:
          description: "Successful execute, find some (or no) task"
          schema:
            $ref: "#/definitions/task"
        412:
          description: "Parameters is not satisfiy required"
  
  /task/state:
    get:
      tags:
        - "Task"
      summary: "Find a task by task id and the accepter's username"
      description: "Set both task_id and username, then the api will return the relations state."
      produces:
        - "application/json"
      parameters:
        - name: "task_id"
          in: "query"
          description: "the desired type"
          type: "string"
          required: true
        - name: "username"
          in: "query"
          description: "the user's username"
          type: "string"
          required: true
      responses:
        200:
          description: "Successful execute, find some (or no) task"
          schema:
            $ref: "#/definitions/task"
        412:
          description: "Parameters is not satisfiy required"
  
  /task/acceptance:
    get: 
      tags:
        - "Task"
      summary: "Get relations between a user and a task"
      description: "Get relations between a user and a task"
      produces:
        - "application/json"
      parameters:
        - name: "username"
          in: "query"
          description: "the user's username"
          type: "string"
          required: true
        - name: "task_id"
          in: "query"
          description: "the desired type"
          type: "string"
          required: true
      responses:
        200:
          description: "Successful execute, find some (or no) task"
          schema:
            $ref: "#/definitions/task"
        412:
          description: "Parameters is not satisfiy required"
          
    post:
      tags:
        - "Task"
      summary: "User accept a task"
      produces:
        - "application/json"
        - "application/xml"
      parameters:
        - name: "body"
          in: "body"
          description: "Accept a task"
          required: true
          schema:
            $ref: "#/definitions/task_acceptance"
      responses:
        200:
          description: "Successful execute, find some (or no) accepter"
          schema:
            $ref: "#/definitions/task"
        412:
          description: "Parameters is not satisfiy required"
          
    delete:
      tags:
        - "Task"
      summary: "Quit a task"
      description: "Quit a task"
      produces:
        - "application/json"
        - "application/xml"
      parameters:
        - name: "task_id"
          in: "query"
          description: "the task's id"
          type: "integer"
          required: true
        - name: "username"
          in: "query"
          description: "the quiter's username"
          type: "string"
          required: true
      responses:
        200:
          description: "Successful execute, find some (or no) task"
          schema:
            $ref: "#/definitions/task"
        412:
          description: "Parameters is not satisfiy required"
  
  /task/complement:
    post:
      tags:
        - "Task"
      summary: "Complete a task"
      description: "Complete a task, remember to give a score"
      produces:
        - "application/json"
        - "application/xml"
      parameters:
        - name: "body"
          in: "body"
          required: true
          schema:
            $ref: "#/definitions/task_complement"
      responses:
        200:
          description: "Successful execute, find some (or no) task"
          schema:
            $ref: "#/definitions/task"
        412:
          description: "Parameters is not satisfiy required"

# securityDefinitions:
#   petstore_auth:
#     type: "oauth2"
#     authorizationUrl: "http://petstore.swagger.io/oauth/dialog"
#     flow: "implicit"
#     scopes:
#       write:pets: "modify pets in your account"
#       read:pets: "read your pets"
#   api_key:
#     type: "apiKey"
#     name: "api_key"
#     in: "header"   
   
      
definitions:     
  Teamlabels:
    type: "object"
    required:
    - "team_id"
    - "label"
    properties:
      team_id:
        type: "integer"
        format: "int32"
      label:
        type: "string"
    xml:
      name: "Teamlabels"
      
  Members:
    type: "object"
    required:
    - "team_id"
    - "member_username"
    properties:
      team_id:
        type: "integer"
        format: "int32"
      member_username:
        type: "string"
    xml:
      name: "Members"
      
  Team:
    type: "object"
    required:
    - "team_name"
    - "leader"
    properties:
      team_id:
        type: "integer"
        format: "int32"
      team_name:
        type: "string"
      leader:
        type: "string"
      logo:
        type: "string"
      description:
        type: "string"
      limit:
        type: "integer"
        format: "int32"
      teamlabels:
        type: "array"
        items:
          $ref: "#/definitions/Teamlabels"
      members:
        type: "array"
        items:
          $ref: "#/definitions/Members"
    xml:
      name: "Team"
      
  TeamModel:
    type: "object"
    required:
    - "team_name"
    - "leader"
    - "members"
    properties:
      team_name:
        type: "string"
        example: ""
      leader:
        type: "string"
        example: ""
      logo:
        type: "string"
        example: ""
      description:
        type: "string"
        example: ""
      limit:
        type: "integer"
        format: "int32"
      teamlabels:
        type: "array"
        items:
          $ref: "#/definitions/labels"
      members:
        type: "array"
        items:
          $ref: "#/definitions/members"
    xml:
      name: "TeamModel"
  
  TeamModel2:
    type: "object"
    required:
    - "team_id"
    - "leader"
    - "members"
    properties:
      team_id:
        type: "integer"
        format: "int32"
      team_name:
        type: "string"
        example: ""
      leader:
        type: "string"
        example: ""
      logo:
        type: "string"
        example: ""
      description:
        type: "string"
        example: ""
      limit:
        type: "integer"
        format: "int32"
      teamlabels:
        type: "array"
        items:
          $ref: "#/definitions/labels"
      
    xml:
      name: "TeamModel2"
      
  labels:
    type: "object"
    required:
    - "label"
    properties:
      label:
        type: "string"
        example: ""
    xml:
      name: "labels"
      
  members:
    type: "object"
    required:
    - "member_username"
    properties:
      member_username:
        type: "string"
        example: ""
    xml:
      name: "members"
      
  Invitation:
    type: "object"
    required:
    - "team_id"
    - "leader"
    - "user"
    properties:
      team_id:
        type: "integer"
        format: "int32"
      leader:
        type: "string"
        example: ""
      user:
        type: "array"
        items:
          type: "object"
          properties:
            username:
              type: "string"
              example: ""
    xml:
      name: "Invitation"
      
  Addition:
    type: "object"
    required:
    - "team_id"
    - "username"
    properties:
      team_id:
        type: "integer"
        format: "int32"
      username:
        type: "string"
        example: ""
    xml:
      name: "Addition"

  task:
    type: "object"
    required:
    - "task_id"
    - "introduction"
    - "money"
    - "score"
    - "number"
    - "publisher"
    - "state"
    - "type"
    properties:
      task_id:
        type: "integer"
        format: "int32"
      introduction:
        type: "string"
        example: "a task can be done"
      money:
        type: "number"
        example: 10
        description: "The money will be paid"
      max_accepter_number:
        type: "integer"
        example: "100"
        description: "Max number of people who can accept the task"
      publisher:
        type: "string"
        example: "hyx"
        description: "The username of the release user"
      state:
        type: "string"
        example: "processing"
      type:
        type: "integer"
        example: 2
    xml:
      name: "task"

  task_create_param:
    type: "object"
    required:
      - "title"
      - "introduction"
      - "money"
      - "score"
      - "number"
      - "publisher"
      - "type"
    properties:
      title:
        type: "string"
        example: "Help me to buy food"
      introduction:
        type: "string"
        example: "a task can be done"
      money:
        type: "number"
        example: 10
        description: "The money will be paid"
      max_accepter_number:
        type: "integer"
        example: "100"
        description: "Max number of people who can accept the task"
      publisher:
        type: "string"
        example: "hyx"
        description: "The username of the release user"
      type:
        type: "integer"
        example: 2
    xml:
      name: "task"
  
  task_acceptance:
    type: "object"
    required: 
      - "task_id"
      - "username"
    properties:
      task_id:
        type: "integer"
        example: 2
      username:
        type: "string"
        example: "hyx"
        description: "The accepter's username"
    xml:
      name: "task_acceptance"
  
  task_complement:
    type: "object"
    required: 
      - "task_id"
      - "username"
      - "score"
    properties:
      task_id:
        type: "integer"
        example: 2
      username:
        type: "string"
        example: "hyx"
      score:
        type: "number"
        description: "The score that give to the publisher"
        example: 4.5
    xml:
      name: "task_complement"
